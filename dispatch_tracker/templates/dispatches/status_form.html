{% extends "base.html" %}
{% block title %}Update Status{% endblock %}
{% block content %}
<div class="card" style="max-width:560px;margin:0 auto;">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;">
    <h2 style="margin:0;">Update Dispatch #{{ dispatch.id }} Status</h2>
    <a class="btn" href="{% url 'dispatches:driver-my' %}">‚Üê Back</a>
  </div>

  <p><b>Current:</b> {{ dispatch.get_status_display }}</p>

  <form method="post" novalidate>
    {% csrf_token %}

    {% if form.non_field_errors %}
      <div style="background:#fff3f3;border:1px solid #ffd0d0;color:#b01e2f;border-radius:10px;padding:.75rem;margin-bottom:1rem;">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    {% if form.status.field.choices %}
      <div style="margin-bottom:1rem;">
        <label style="display:block;font-weight:600;margin-bottom:.35rem;" for="{{ form.status.id_for_label }}">
          {{ form.status.label }}
        </label>
        {{ form.status }}
        {{ form.status.errors }}
      </div>

      {% if form.note %}
      <div style="margin-bottom:1rem;">
        <label style="display:block;font-weight:600;margin-bottom:.35rem;" for="{{ form.note.id_for_label }}">
          {{ form.note.label }} <span style="font-weight:400;color:#666;">(optional)</span>
        </label>
        {{ form.note }}
        {{ form.note.errors }}
      </div>
      {% endif %}

      <button class="btn btn-primary" type="submit">Update</button>
      <a class="btn" href="{% url 'dispatches:driver-my' %}" style="margin-left:.5rem;">Cancel</a>
    {% else %}
      <p>No further actions are available for this dispatch.</p>
      <a class="btn" href="{% url 'dispatches:driver-my' %}">OK</a>
    {% endif %}
  </form>
</div>
{% endblock %}
